\documentclass[8pt,aspectratio=169]{beamer}
\usetheme{Madrid}
\usepackage{graphicx,booktabs,adjustbox,multicol,amsmath,amssymb}
\definecolor{mlblue}{RGB}{0,102,204}
\definecolor{mlpurple}{RGB}{51,51,178}
\definecolor{mllavender}{RGB}{173,173,224}
\definecolor{mllavender2}{RGB}{193,193,232}
\definecolor{mllavender3}{RGB}{204,204,235}
\definecolor{mllavender4}{RGB}{214,214,239}
\definecolor{mlorange}{RGB}{255,127,14}
\definecolor{mlgreen}{RGB}{44,160,44}
\definecolor{mlred}{RGB}{214,39,40}
\setbeamercolor{palette primary}{bg=mllavender3,fg=mlpurple}
\setbeamercolor{palette secondary}{bg=mllavender2,fg=mlpurple}
\setbeamercolor{palette tertiary}{bg=mllavender,fg=white}
\setbeamercolor{structure}{fg=mlpurple}
\setbeamercolor{frametitle}{fg=mlpurple,bg=mllavender3}
\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{itemize items}[circle]
\setbeamersize{text margin left=5mm,text margin right=5mm}

\title{Lesson 17: Proof of Stake}
\subtitle{Module 2: Blockchain Fundamentals}
\author{Digital Finance}
\date{}

\begin{document}

\begin{frame}
\titlepage
\end{frame}

\begin{frame}{Why Proof of Stake?}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Proof of Work Limitations:}
\begin{itemize}
\item Energy consumption (150+ TWh/year)
\item Hardware waste (ASICs obsolete in 1--2 years)
\item Centralization pressure (economies of scale)
\item Slow finality (probabilistic)
\end{itemize}

\vspace{3mm}
\textbf{PoS Alternative:}
\begin{itemize}
\item Replace computation with capital
\item Energy efficiency (99.95\% reduction)
\item Economic security
\item Faster finality
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/pow_vs_pos_comparison.pdf}
\end{columns}
\end{frame}

\begin{frame}{Core Concept: Stake as Security Deposit}
\begin{center}
\includegraphics[width=0.85\textwidth]{charts/lesson_17/staking_concept.pdf}
\end{center}
\vspace{-3mm}
\textbf{Key Idea:}
\begin{itemize}
\item Validators lock up capital (stake) as collateral
\item Selected to propose blocks based on stake size
\item Earn rewards for honest behavior
\item Lose stake for dishonest behavior (slashing)
\item \textbf{Attack cost:} Must acquire and lock majority of stake
\end{itemize}
\end{frame}

\begin{frame}{Validator Selection Mechanisms}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{1. Random Selection (weighted):}
\begin{itemize}
\item Higher stake = higher probability
\item Not purely proportional (prevents centralization)
\item Randomness from VRF (Verifiable Random Function)
\end{itemize}

\vspace{3mm}
\textbf{2. Coin Age:}
\begin{itemize}
\item Priority based on stake $\times$ time held
\item Resets after block proposal
\item Incentivizes long-term holding
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/validator_selection.pdf}
\end{columns}
\end{frame}

\begin{frame}{Ethereum's Proof of Stake: Beacon Chain}
\textbf{Requirements:}
\begin{itemize}
\item Minimum stake: 32 ETH per validator
\item Run validator node (beacon node + execution client)
\item Uptime requirement: $>$99\% to maintain profitability
\end{itemize}

\vspace{3mm}
\textbf{Epoch and Slot Structure:}
\begin{itemize}
\item \textbf{Slot:} 12 seconds (one block opportunity)
\item \textbf{Epoch:} 32 slots = 6.4 minutes
\item Each epoch, validators assigned to slots and committees
\item Finality achieved after 2 epochs ($\sim$13 minutes)
\end{itemize}

\vspace{3mm}
\textbf{Roles per Epoch:}
\begin{itemize}
\item \textbf{Proposer:} One validator per slot, proposes block
\item \textbf{Attesters:} Committees of validators vote on block validity
\end{itemize}
\end{frame}

\begin{frame}{Ethereum PoS Architecture}
\begin{center}
\includegraphics[width=0.9\textwidth]{charts/lesson_17/ethereum_pos_architecture.pdf}
\end{center}
\vspace{-3mm}
\textbf{Consensus Flow:}
\begin{enumerate}
\item Proposer selected for slot (pseudo-random, stake-weighted)
\item Proposer creates block, broadcasts to network
\item Attesters vote on block (organized in committees)
\item Aggregated attestations included in next block
\item After 2 epochs, block finalized (cannot be reverted)
\end{enumerate}
\end{frame}

\begin{frame}{Rewards and Penalties}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Rewards (per epoch):}
\begin{itemize}
\item Timely attestations: $\sim$0.000015 ETH
\item Block proposals: $\sim$0.0002 ETH
\item Sync committee: $\sim$0.0001 ETH
\item Annual yield: 3--5\% APR
\end{itemize}

\vspace{3mm}
\textbf{Penalties:}
\begin{itemize}
\item Offline: Miss rewards + small penalty
\item Late attestations: Reduced rewards
\item Slashing: Major stake loss (see next slide)
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/reward_structure.pdf}
\end{columns}
\end{frame}

\begin{frame}{Slashing: Punishing Malicious Behavior}
\textbf{Slashable Offenses:}
\begin{enumerate}
\item \textbf{Double Proposal:} Proposing two different blocks in same slot
\item \textbf{Surround Vote:} Attestation contradicting previous attestation
\item \textbf{Double Vote:} Two attestations for same slot with different targets
\end{enumerate}

\vspace{3mm}
\textbf{Slashing Penalties:}
\begin{itemize}
\item Immediate penalty: 1 ETH (minimum)
\item Correlation penalty: Scales with number of validators slashed simultaneously
\item Maximum penalty: Entire 32 ETH stake (if many validators slashed together)
\item Forced exit: Validator ejected from network
\end{itemize}

\vspace{3mm}
\textbf{Design Goal:} Make coordinated attacks extremely expensive
\end{frame}

\begin{frame}{Slashing Correlation Penalty}
\begin{center}
\includegraphics[width=0.85\textwidth]{charts/lesson_17/slashing_correlation.pdf}
\end{center}
\vspace{-3mm}
\textbf{Formula:}
\[
\text{Penalty} = \text{Base} + \text{Stake} \times \frac{\text{Slashed Validators}}{\text{Total Validators}} \times 3
\]

\textbf{Example:} If 33\% of validators slashed together, each loses entire stake
\end{frame}

\begin{frame}{The Merge: Ethereum's Transition (Sept 15, 2022)}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Before:}
\begin{itemize}
\item Proof of Work (since 2015)
\item Energy: $\sim$78 TWh/year
\item Issuance: $\sim$13,000 ETH/day
\item Block time: $\sim$13 seconds
\end{itemize}

\vspace{3mm}
\textbf{After:}
\begin{itemize}
\item Proof of Stake
\item Energy: $\sim$0.01 TWh/year (99.95\% reduction)
\item Issuance: $\sim$1,600 ETH/day (88\% reduction)
\item Block time: 12 seconds (fixed)
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/the_merge_impact.pdf}
\end{columns}
\end{frame}

\begin{frame}{Environmental Impact: Before and After The Merge}
\begin{center}
\includegraphics[width=0.9\textwidth]{charts/lesson_17/energy_comparison.pdf}
\end{center}
\vspace{-3mm}
\textbf{Comparison (Annualized):}
\begin{itemize}
\item \textbf{PoW Ethereum:} 78 TWh/year $\approx$ Chile's electricity consumption
\item \textbf{PoS Ethereum:} 0.01 TWh/year $\approx$ 2,000 households
\item \textbf{Per transaction:} PoW $\sim$200 kWh $\rightarrow$ PoS $\sim$0.01 kWh (20,000x improvement)
\end{itemize}
\end{frame}

\begin{frame}{Staking Economics: Solo vs Pooled}
\begin{center}
\includegraphics[width=0.85\textwidth]{charts/lesson_17/staking_options.pdf}
\end{center}
\vspace{-3mm}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Solo Staking:}
\begin{itemize}
\item 32 ETH minimum
\item Full control, maximum rewards
\item Technical expertise required
\item Hardware costs
\end{itemize}

\column{0.48\textwidth}
\textbf{Pooled/Liquid Staking:}
\begin{itemize}
\item Any amount (e.g., Lido, Rocket Pool)
\item Receive staking derivative (stETH)
\item Lower rewards (pool fees 10--15\%)
\item Easier, but centralization risk
\end{itemize}
\end{columns}
\end{frame}

\begin{frame}{Liquid Staking Derivatives (LSDs)}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Problem:}
\begin{itemize}
\item Staked ETH locked until withdrawals enabled
\item Lost liquidity
\item Opportunity cost
\end{itemize}

\vspace{3mm}
\textbf{Solution:}
\begin{itemize}
\item Deposit ETH, receive stETH (1:1)
\item stETH accrues staking rewards
\item Tradeable on DeFi markets
\item Use as collateral
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/liquid_staking_flow.pdf}
\end{columns}

\vspace{3mm}
\textbf{Risks:} Centralization (Lido has $>$30\% of staked ETH), smart contract risk, de-peg risk
\end{frame}

\begin{frame}{Lido Dominance: Centralization Concern}
\begin{center}
\includegraphics[width=0.85\textwidth]{charts/lesson_17/staking_pool_distribution.pdf}
\end{center}
\vspace{-3mm}
\textbf{Concerns:}
\begin{itemize}
\item Lido controls $>$30\% of staked ETH (as of 2024)
\item Single point of failure for governance
\item Risk of coordinated censorship
\end{itemize}
\textbf{Mitigation:} Self-limiting proposals, multi-operator model, community governance
\end{frame}

\begin{frame}{Finality: Proof of Stake Advantage}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Proof of Work:}
\begin{itemize}
\item Probabilistic finality
\item Never 100\% certain
\item 6 confirmations $\approx$ 1 hour (Bitcoin)
\item Longest chain rule
\end{itemize}

\vspace{3mm}
\textbf{Proof of Stake (Ethereum):}
\begin{itemize}
\item Economic finality
\item 2 epochs ($\sim$13 minutes)
\item Reversion requires $>$50\% stake loss
\item Absolute finality
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/finality_comparison.pdf}
\end{columns}
\end{frame}

\begin{frame}{Security Model: PoW vs PoS}
\begin{center}
\begin{tabular}{@{}p{3.5cm}p{5cm}p{5cm}@{}}
\toprule
\textbf{Aspect} & \textbf{Proof of Work} & \textbf{Proof of Stake} \\
\midrule
Attack Cost & Buy hashrate (hardware + electricity) & Acquire majority stake \\
\midrule
Attack Aftermath & Can reuse hardware & Stake slashed, loses capital \\
\midrule
Defense & Increase difficulty, dilute attacker hashrate & Slash attacker stake \\
\midrule
Recovery & Continue mining normally & Coordination for hard fork \\
\midrule
Long-Range Attack & Not possible (checkpoints) & Weak subjectivity needed \\
\bottomrule
\end{tabular}
\end{center}

\vspace{3mm}
\textbf{Key Difference:} PoS attacks destroy attacker's capital, PoW attacks do not
\end{frame}

\begin{frame}{Nothing-at-Stake Problem}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Problem:}
\begin{itemize}
\item In PoW, mining on two chains splits hashrate
\item In PoS, validating on two chains costs nothing
\item Rational to vote on all forks
\item Prevents convergence
\end{itemize}

\vspace{3mm}
\textbf{Solution:}
\begin{itemize}
\item Slashing for double-voting
\item Casper FFG rules (Ethereum)
\item Economic penalties enforce single chain
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/nothing_at_stake.pdf}
\end{columns}
\end{frame}

\begin{frame}{Long-Range Attack and Weak Subjectivity}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Long-Range Attack:}
\begin{itemize}
\item Attacker acquires old private keys
\item Rewrites history from genesis
\item No computational cost (unlike PoW)
\item Creates alternative chain
\end{itemize}

\vspace{3mm}
\textbf{Weak Subjectivity:}
\begin{itemize}
\item New nodes must checkpoint recent state
\item Cannot sync from genesis alone
\item Trusted source for initial sync
\item Checkpoints updated periodically
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/long_range_attack.pdf}
\end{columns}
\end{frame}

\begin{frame}{Other PoS Implementations}
\begin{center}
\begin{tabular}{@{}p{2.5cm}p{3cm}p{4cm}p{3.5cm}@{}}
\toprule
\textbf{Chain} & \textbf{Consensus} & \textbf{Min Stake} & \textbf{Features} \\
\midrule
Ethereum & Casper FFG + LMD GHOST & 32 ETH & Slashing, finality \\
\midrule
Cardano & Ouroboros & Any (pool delegation) & Peer-reviewed, formal verification \\
\midrule
Polkadot & GRANDPA + BABE & 350 DOT (nominator) & Nominated PoS, parachains \\
\midrule
Cosmos & Tendermint & Any (delegated) & Instant finality, IBC \\
\midrule
Solana & Tower BFT & Any (delegated) & Proof of History hybrid \\
\bottomrule
\end{tabular}
\end{center}
\end{frame}

\begin{frame}{Delegated Proof of Stake (DPoS)}
\begin{columns}[T]
\column{0.48\textwidth}
\textbf{Mechanism:}
\begin{itemize}
\item Token holders vote for validators
\item Limited validator set (21--100)
\item Validators produce blocks in rotation
\item Faster, more scalable
\end{itemize}

\vspace{3mm}
\textbf{Examples:}
\begin{itemize}
\item EOS (21 validators)
\item Tron (27 validators)
\item Cosmos Hub (175 validators)
\end{itemize}

\column{0.48\textwidth}
\includegraphics[width=\textwidth]{charts/lesson_17/dpos_model.pdf}
\end{columns}

\vspace{3mm}
\textbf{Trade-off:} Performance vs decentralization (fewer validators = more centralized)
\end{frame}

\begin{frame}{Criticisms of Proof of Stake}
\begin{itemize}
\item \textbf{``Rich Get Richer'':} Rewards proportional to stake, concentrates wealth
  \begin{itemize}
  \item Counterargument: PoW also centralizes (economies of scale in mining)
  \end{itemize}
\item \textbf{Centralization:} Large staking pools (Lido $>$30\% on Ethereum)
  \begin{itemize}
  \item Counterargument: PoW mining pools also concentrated
  \end{itemize}
\item \textbf{Complexity:} Slashing, finality gadgets, weak subjectivity
  \begin{itemize}
  \item Counterargument: Enables features impossible in PoW
  \end{itemize}
\item \textbf{Plutocracy:} Governance by wealthy token holders
  \begin{itemize}
  \item Counterargument: Better than PoW's hardware oligopoly
  \end{itemize}
\item \textbf{Unproven:} Shorter track record than PoW
  \begin{itemize}
  \item Counterargument: Ethereum's Merge successful so far (2+ years)
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Summary}
\begin{itemize}
\item \textbf{Proof of Stake:} Replace computation with capital, 99.95\% energy reduction
\item \textbf{Validators:} Lock stake (32 ETH on Ethereum), earn rewards, slashed if malicious
\item \textbf{The Merge (2022):} Ethereum transitioned PoW $\rightarrow$ PoS successfully
\item \textbf{Finality:} 2 epochs ($\sim$13 min) for absolute finality vs probabilistic PoW
\item \textbf{Challenges:} Centralization (Lido), nothing-at-stake, long-range attacks
\item \textbf{Trade-offs:} Energy efficiency vs complexity, different trust assumptions
\end{itemize}

\vspace{4mm}
\textbf{Next Lesson:} Bitcoin Architecture -- UTXO model and transaction mechanics
\end{frame}

\end{document}
